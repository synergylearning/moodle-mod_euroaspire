YUI.add("moodle-mod_euroaspire-addevidence",function(e,t){var n={URLERROR:"urlerror",SPINNER:"spinner"},r={LINK:"input.evidenceurl",FORM:"form.mform",URLERROR:"form.mform .urlerror",FORMITEM:".fitem",SPINNER:".spinner"};M.mod_euroaspire=M.mod_euroaspire||{},M.mod_euroaspire.addevidence={currentValues:{},url:"",cmid:null,init:function(t){"use strict";var n;this.url=M.cfg.wwwroot+"/mod/euroaspire/assessment/ajax_getlinktitle.php",this.cmid=t.cmid,this.storeCurrentValues(),n=e.one(r.FORM),n.delegate("blur",this.updateTitle,r.LINK,this)},storeCurrentValues:function(){"use strict";e.all(r.LINK).each(function(e){this.currentValues[e.get("id")]=e.get("value").trim()},this)},updateTitle:function(t){"use strict";var n,r,i,s,o;this.removeErrors(),r=t.currentTarget,i=r.get("id"),s=r.get("value").trim(),n=this.currentValues[i];if(n===s)return;this.currentValues[i]=s,o=this.getTitleNode(r);if(!o)return;if(!s){o.set("value","");return}this.addSpinner(o),e.io(this.url,{data:{id:this.cmid,url:s,sesskey:M.cfg.sesskey},on:{success:function(e,t){var n;try{n=JSON.parse(t.responseText)}catch(r){}if(!n||n.error||!n.title){this.addError(o);return}o.set("value",n.title)},complete:function(){this.removeSpinner(o)}},context:this})},removeErrors:function(){"use strict";e.all(r.URLERROR).remove(!0)},getTitleNode:function(t){"use strict";var n;return n=t.get("id"),n=n.replace("url","urltitle"),e.one("#"+n)},addError:function(t){"use strict";var i,s,o,u;s=t.ancestor(r.FORMITEM);if(!s)return;o=s.ancestor(),i=e.Node.create("<div>"+M.util.get_string("titleerror","mod_euroaspire")+"</div>"),i.addClass(n.URLERROR),i.addClass("felement"),u=e.Node.create('<div class="fitem"></div>'),u.appendChild(i),o.insertBefore(u,s)},addSpinner:function(t){"use strict";var n,r;this.removeSpinner(t),r=e.Node.create('<span class="spinner"></span>'),n=t.ancestor(),n.appendChild(r),t.set("disabled","disabled")},removeSpinner:function(e){"use strict";var t;t=e.ancestor(),t.all(r.SPINNER).remove(!0),e.removeAttribute("disabled")}}},"@VERSION@",{requires:["node","event-focus","io-base"]});
